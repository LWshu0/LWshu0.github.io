---
title: E-R模型
copyright: true
date: 2023-10-09 22:51:32
updated: 2023-10-09 22:51:32
tags:
    - 数据库
    - 课程笔记
categories:
    - 数据库
    - 课程学习笔记
# excerpt:
# index_img:
# banner_img:
---
# E-R(实体-联系)模型

## 基本概念

### 实体

**实体** 是现实世界中可以唯一区分的个体/对象. 使用 **属性** 来描述一个实体的性质, 根据属性的 **值** 我们可以有关这个实体的一些信息.

**实体集** 是相同类型(具有相同属性)的一个实体的集合

### 联系

**联系** 是多个实体间的相互关联.

**联系集** 是相同类型的联系的集合. 实体集之间的关联称为 **参与**, 实体集可以参与到多个联系集中. 参与联系集的实体集个数为联系集的 **度**. 实体在联系中扮演的功能称为 **角色**

### 属性

属性的可取值范围为属性的 **域**, 或者 **值集**.

划分:

- 简单和复合属性: 简单属性是不可划分的最小属性, 符合属性可以由简单属性和复合属性聚集得到
- 单值和多值属性: 对于一个实体, 属性的取值只有一个称为单值属性, 可以有多个称为多值属性
- 派生属性: 从别的相关属性或实体派生出来(即可以通过它们以一定的计算方法得到)

### 约束

#### 映射基数

一个实体通过一个联系集可以关联到的实体个数, 分为一对一, 一对多, 多对一, 多对多.

![1696864417344](/img/E-R模型/1696864417344.png)

#### 参与约束

一个实体集中的实体全部参与到联系中, 称这个联系为 **全部**的, 否则是 **部分**的

#### 码

数据库中一个实体的属性必须可以作为该实体的唯一标识
假设 $R$ 是一个涉及实体集 $E_1, E_2, \dots, E_n$ 的联系, 那么 $primary\_key(E_1) \cup primary\_key(E_2) \cup \dots \cup primary\_key(E_n) \cup \{ a_1, a_2, \dots , a_m \}$ 就是联系集 $R$ 的一个超码, 其中 $a_i$ 是联系集的一些属性.

## E-R图

### 基本结构

- 分隔的矩形: 实体集, 第一部分是实体集名称, 第二部分是实体集属性
- 菱形: 联系集
- 未分隔的矩形: 联系集的属性
- 线段: 表示实体集参与到联系集(映射基数为多)
- 箭头: 指向联系集关联的实体集(映射基数为1)
- 虚线: 将联系集属性连接到联系集
- 双线: 实体集中的实体在联系集中全参与
- 双菱形: 连接到弱实体集的标志性联系集

### 映射基数

![1696866602384](/img/E-R模型/1696866602384.png)

还可以在线段的上面标识 $l..h$ 来约束映射基数的上下界, 最大值 $h$ 为 $*$ 代表没有上限.

### 属性

![1696866887128](/img/E-R模型/1696866887128.png)

其中name, address, street为复合属性, phone_number为多值属性(用花括号括起来), age是派生属性(后面跟小括号)

### 角色

![1696867069451](/img/E-R模型/1696867069451.png)

同一个实体集多次参与一个联系, 需要在连线上标识角色, 这里是course_id和prereq_id.

### 弱实体集

在删除实体集中冗余的属性时, 会造成一些实体集中属性无法唯一标识一个实体, 这些实体集就叫 **弱实体集**. 弱实体集必须与另一个称作 **标识** 或者 **属主实体集** 的实体集关联才有意义, 即弱实体集的存在依赖于标识实体集, 将弱实体集和标识实体集关联的联系是 **标识性联系**

区分弱实体集中实体的属性集合称为 **分辨符**, 在E-R图中用下划虚线指明.

### 联系集

联系集的主码

- 多对多的二元联系, 参与实体集的主码属性的并集成为联系集的主码
- 一对一的二元联系集, 任意一个实体集的主码都可以为联系集的主码
- 多对一或一对多的二元联系集, 联系集中多的那一方的实体集的主码为联系集的主码
- 对于全是多的n元联系, 所有参与的实体集的主码的并集为联系集的主码
- 其中有一个是一的n元联系, 除一的那个实体集之外的所有实体集的主码并集为联系集的主码

可以合并的模式

- 弱实体集主码(包括依赖的那些属性和自身的分辨码)包含强实体集的主码
- 多对一的联系集, 可以把'多'实体集和联系集合并为一个
- 一对一的联系集, 可以把联系集和任意一个实体集合并

## 拓展的 E-R 特性

### 特化和概化

![1697095093271](/img/E-R模型/1697095093271.png)

特化: 自顶向下, 在实体集内部进一步分组

重叠特化: 一个实体集可能属于多个特化实体集, 在E-R图中使用分开的两个箭头指向(图中的employee和student)

不相交特化: 一个实体集至多属于一个特化实体集, 在E-R图中使用一个箭头指向(图中的instructor和secretary)

概化: 自底向上, 多个实体集根据共同的特征综合为一个更高层的实体集

高层和低层实体集可被分别称为 **超类** 和 **子类**, 子类会继承所有超类的属性(类似c++中的类, 沿继承树向上找所有属性)

### 概化上的约束

成员资格

- 条件定义的: 实体需要满足特定的成员资格条件或者谓词才能属于低层实体集
- 用户定义的: 由数据库用户指派实体集所属的低层实体集

实体是否可属于多个实体集

- 不相交的: 一个实体至多属于一个低层实体集
- 重叠: 同一个实体可以属于一个或多个低层实体集

概化的完全性约束

- 全部概化/特化: 每个高层实体必须属于一个低层实体集
- 部分概化/特化: 一些高层实体集不属于任何低层实体集, 这是默认的

### 聚集

将联系集及其关联的实体集看作一个整体的实体集, 这个实体集可以参与到其他联系中.

## E-R 图其他表示

教材第五版及之前的表示E-R图方式

![1697103578570](/img/E-R模型/1697103578570.png)

UML类图表示法

![1697103675433](/img/E-R模型/1697103675433.png)
